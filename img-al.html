<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Photos AI Studio | Smart Image Generator with Memory</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Google Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        :root {
            --google-blue: #1a73e8;
            --google-blue-dark: #0d62d9;
            --google-red: #ea4335;
            --google-yellow: #fbbc04;
            --google-green: #34a853;
            --google-purple: #8a4dff;
            --dark-bg: #202124;
            --darker-bg: #171717;
            --card-bg: #2d2e30;
            --border-color: #3c4043;
            --text-primary: #e8eaed;
            --text-secondary: #9aa0a6;
            --text-tertiary: #5f6368;
            --accent-blue: #1a73e8;
            --accent-purple: #8a4dff;
            --shadow: 0 1px 3px rgba(0,0,0,.3);
            --card-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.5;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(26, 115, 232, 0.08) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(138, 77, 255, 0.08) 0%, transparent 40%);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header */
        .google-header {
            padding: 16px 0;
            border-bottom: 1px solid var(--border-color);
            background: rgba(32, 33, 36, 0.95);
            backdrop-filter: blur(20px);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-circle {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--google-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 500;
        }
        
        .logo-text {
            font-size: 20px;
            font-weight: 500;
        }
        
        .logo-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-left: 4px;
        }
        
        .header-stats {
            display: flex;
            align-items: center;
            gap: 24px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 20px;
            font-weight: 500;
            color: var(--accent-purple);
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 380px 1fr;
            gap: 24px;
            margin: 24px 0;
            min-height: calc(100vh - 140px);
        }
        
        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }
        
        /* Control Panel */
        .control-panel {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid var(--border-color);
            box-shadow: var(--card-shadow);
            height: fit-content;
            position: sticky;
            top: 100px;
        }
        
        .panel-title {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 20px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .panel-title i {
            color: var(--accent-blue);
        }
        
        /* Smart Prompt Section */
        .smart-prompt-section {
            margin-bottom: 24px;
        }
        
        .prompt-textarea {
            width: 100%;
            background: var(--darker-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 16px;
            font-size: 15px;
            color: var(--text-primary);
            resize: vertical;
            min-height: 120px;
            line-height: 1.6;
            font-family: inherit;
            transition: all 0.2s;
        }
        
        .prompt-textarea:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
        }
        
        .prompt-actions {
            display: flex;
            gap: 10px;
            margin-top: 12px;
        }
        
        .prompt-action-btn {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .prompt-action-btn:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: var(--accent-blue);
        }
        
        /* Previous Prompts */
        .previous-prompts {
            background: rgba(138, 77, 255, 0.05);
            border: 1px solid rgba(138, 77, 255, 0.2);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            display: none;
        }
        
        .previous-prompts.active {
            display: block;
        }
        
        .previous-title {
            color: var(--accent-purple);
            font-weight: 500;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .prompt-history {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .history-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 10px 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 13px;
        }
        
        .history-item:hover {
            background: rgba(138, 77, 255, 0.1);
            border-color: var(--accent-purple);
        }
        
        .history-date {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 4px;
        }
        
        /* Style Selection */
        .style-section {
            margin-bottom: 24px;
        }
        
        .style-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .style-option {
            background: var(--darker-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .style-option:hover {
            border-color: var(--accent-blue);
            transform: translateY(-2px);
        }
        
        .style-option.active {
            border-color: var(--accent-blue);
            background: rgba(26, 115, 232, 0.1);
        }
        
        .style-icon {
            font-size: 20px;
            margin-bottom: 8px;
            color: var(--accent-blue);
        }
        
        .style-name {
            font-weight: 500;
            margin-bottom: 4px;
        }
        
        .style-desc {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        /* Aspect Ratio */
        .aspect-section {
            margin-bottom: 24px;
        }
        
        .aspect-options {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }
        
        .aspect-option {
            background: var(--darker-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 12px 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .aspect-option:hover {
            border-color: var(--accent-blue);
        }
        
        .aspect-option.active {
            border-color: var(--accent-blue);
            background: rgba(26, 115, 232, 0.1);
        }
        
        .aspect-ratio {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
        }
        
        .aspect-desc {
            font-size: 11px;
            color: var(--text-secondary);
        }
        
        /* Memory Settings */
        .memory-section {
            background: rgba(26, 115, 232, 0.05);
            border: 1px solid rgba(26, 115, 232, 0.2);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 24px;
        }
        
        .memory-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .memory-title {
            color: var(--accent-blue);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .memory-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .toggle-switch {
            width: 40px;
            height: 20px;
            background: var(--border-color);
            border-radius: 20px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .toggle-switch.active {
            background: var(--accent-blue);
        }
        
        .toggle-knob {
            width: 16px;
            height: 16px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: all 0.3s;
        }
        
        .toggle-switch.active .toggle-knob {
            left: 22px;
        }
        
        /* Generate Button */
        .generate-section {
            margin-top: 8px;
        }
        
        .generate-button {
            width: 100%;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            color: white;
            border: none;
            padding: 16px;
            font-size: 16px;
            font-weight: 500;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);
        }
        
        .generate-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(26, 115, 232, 0.4);
        }
        
        .generate-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .daily-limit {
            text-align: center;
            color: var(--google-yellow);
            font-size: 13px;
            margin-top: 12px;
            display: none;
        }
        
        /* Main Gallery Area */
        .gallery-area {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid var(--border-color);
            box-shadow: var(--card-shadow);
            display: flex;
            flex-direction: column;
        }
        
        .gallery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .gallery-title {
            font-size: 20px;
            font-weight: 500;
        }
        
        .gallery-actions {
            display: flex;
            gap: 12px;
        }
        
        .gallery-button {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .gallery-button:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.12);
            border-color: var(--accent-blue);
        }
        
        .gallery-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Current Image Display */
        .current-image-container {
            background: var(--darker-bg);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            border: 2px dashed var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            position: relative;
        }
        
        .placeholder-content {
            text-align: center;
            color: var(--text-secondary);
            max-width: 400px;
        }
        
        .placeholder-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        .placeholder-title {
            font-size: 18px;
            margin-bottom: 8px;
            color: var(--text-primary);
        }
        
        .placeholder-text {
            font-size: 14px;
            line-height: 1.6;
        }
        
        .generated-image {
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
            display: none;
            position: relative;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }
        
        #currentImage {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .image-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, transparent 30%, transparent 70%, rgba(0,0,0,0.9) 100%);
            padding: 20px;
            color: white;
            display: none;
        }
        
        .image-prompt {
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .image-meta {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .image-badges {
            position: absolute;
            top: 16px;
            right: 16px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .image-badge {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
            backdrop-filter: blur(10px);
        }
        
        .badge-ai {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
        }
        
        .badge-memory {
            background: linear-gradient(135deg, var(--google-green), #059669);
        }
        
        /* Regeneration Options */
        .regeneration-options {
            background: rgba(138, 77, 255, 0.05);
            border: 1px solid rgba(138, 77, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            display: none;
        }
        
        .regeneration-options.active {
            display: block;
        }
        
        .regeneration-title {
            color: var(--accent-purple);
            font-weight: 500;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .regeneration-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .regeneration-button {
            background: rgba(138, 77, 255, 0.1);
            border: 1px solid rgba(138, 77, 255, 0.3);
            color: var(--text-primary);
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            min-width: 200px;
            justify-content: center;
        }
        
        .regeneration-button:hover {
            background: rgba(138, 77, 255, 0.2);
            transform: translateY(-2px);
        }
        
        /* History Gallery */
        .history-gallery {
            margin-top: 24px;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .history-title {
            font-size: 16px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .history-filter {
            display: flex;
            gap: 8px;
        }
        
        .filter-button {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }
        
        .filter-button:hover {
            background: rgba(255, 255, 255, 0.12);
        }
        
        .filter-button.active {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
            color: white;
        }
        
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 16px;
        }
        
        .photo-card {
            background: var(--darker-bg);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .photo-card:hover {
            transform: translateY(-4px);
            border-color: var(--accent-blue);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        
        .photo-thumb {
            width: 100%;
            height: 140px;
            object-fit: cover;
        }
        
        .photo-info {
            padding: 12px;
        }
        
        .photo-prompt {
            font-size: 13px;
            margin-bottom: 4px;
            color: var(--text-primary);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .photo-date {
            font-size: 11px;
            color: var(--text-secondary);
        }
        
        .photo-actions {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .photo-card:hover .photo-actions {
            opacity: 1;
        }
        
        .photo-action-btn {
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.2s;
        }
        
        .photo-action-btn:hover {
            background: var(--accent-blue);
        }
        
        /* Loading */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(32, 33, 36, 0.9);
            backdrop-filter: blur(10px);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 12px;
            z-index: 10;
        }
        
        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 16px;
            margin-bottom: 8px;
            color: white;
        }
        
        .loading-subtext {
            font-size: 14px;
            color: var(--text-secondary);
            max-width: 400px;
            text-align: center;
            line-height: 1.5;
        }
        
        /* Error Message */
        .error-message {
            background: rgba(234, 67, 53, 0.1);
            border: 1px solid rgba(234, 67, 53, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin-top: 20px;
            color: #ff8a80;
            display: none;
            align-items: center;
            gap: 12px;
        }
        
        .error-icon {
            font-size: 20px;
        }
        
        /* Footer */
        .google-footer {
            text-align: center;
            padding: 32px 0;
            border-top: 1px solid var(--border-color);
            margin-top: 40px;
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-top: 16px;
            flex-wrap: wrap;
        }
        
        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .footer-links a:hover {
            color: var(--accent-blue);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .control-panel {
                position: static;
            }
            
            .style-options,
            .aspect-options {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .regeneration-buttons {
                flex-direction: column;
            }
            
            .regeneration-button {
                min-width: 100%;
            }
            
            .photo-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }
        
        /* Smart Suggestions */
        .smart-suggestions {
            background: rgba(52, 168, 83, 0.05);
            border: 1px solid rgba(52, 168, 83, 0.2);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            display: none;
        }
        
        .smart-suggestions.active {
            display: block;
        }
        
        .suggestions-title {
            color: var(--google-green);
            font-weight: 500;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .suggestion-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .suggestion-chip {
            background: rgba(52, 168, 83, 0.1);
            border: 1px solid rgba(52, 168, 83, 0.3);
            color: #c6f6d5;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }
        
        .suggestion-chip:hover {
            background: rgba(52, 168, 83, 0.2);
            transform: translateY(-2px);
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="google-header">
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo-circle">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div>
                        <div class="logo-text">Photos AI Studio</div>
                        <div class="logo-subtitle">Smart Generation with Memory</div>
                    </div>
                </div>
                <div class="header-stats">
                    <div class="stat-item">
                        <div class="stat-number" id="totalImages">0</div>
                        <div class="stat-label">Images Created</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="todayCount">0/100</div>
                        <div class="stat-label">Today's Limit</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="memorySize">0</div>
                        <div class="stat-label">In Memory</div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Main Content -->
    <div class="container">
        <div class="main-layout">
            <!-- Control Panel -->
            <div class="control-panel">
                <h2 class="panel-title">
                    <i class="fas fa-sliders-h"></i>
                    Smart Generator
                </h2>
                
                <!-- Smart Prompt -->
                <div class="smart-prompt-section">
                    <textarea id="promptInput" class="prompt-textarea" placeholder="Describe what you want to create... AI will learn from your previous generations"></textarea>
                    <div class="prompt-actions">
                        <button class="prompt-action-btn" id="suggestBtn">
                            <i class="fas fa-lightbulb"></i>
                            Suggest
                        </button>
                        <button class="prompt-action-btn" id="historyBtn">
                            <i class="fas fa-history"></i>
                            History
                        </button>
                        <button class="prompt-action-btn" id="clearBtn">
                            <i class="fas fa-eraser"></i>
                            Clear
                        </button>
                    </div>
                </div>
                
                <!-- Previous Prompts -->
                <div class="previous-prompts" id="previousPrompts">
                    <div class="previous-title">
                        <i class="fas fa-clock"></i>
                        Your Previous Prompts
                    </div>
                    <div class="prompt-history" id="promptHistory">
                        <!-- Previous prompts will appear here -->
                    </div>
                </div>
                
                <!-- Smart Suggestions -->
                <div class="smart-suggestions" id="smartSuggestions">
                    <div class="suggestions-title">
                        <i class="fas fa-brain"></i>
                        Smart Suggestions
                    </div>
                    <div class="suggestion-chips" id="suggestionChips">
                        <!-- Suggestions will appear here -->
                    </div>
                </div>
                
                <!-- Style Selection -->
                <div class="style-section">
                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 12px;">
                        <i class="fas fa-palette"></i>
                        Art Style
                    </div>
                    <div class="style-options">
                        <div class="style-option active" data-style="realistic">
                            <i class="fas fa-camera style-icon"></i>
                            <div class="style-name">Realistic</div>
                            <div class="style-desc">Photorealistic images</div>
                        </div>
                        <div class="style-option" data-style="cinematic">
                            <i class="fas fa-film style-icon"></i>
                            <div class="style-name">Cinematic</div>
                            <div class="style-desc">Movie-like scenes</div>
                        </div>
                        <div class="style-option" data-style="anime">
                            <i class="fas fa-user-ninja style-icon"></i>
                            <div class="style-name">Anime</div>
                            <div class="style-desc">Japanese animation</div>
                        </div>
                        <div class="style-option" data-style="illustration">
                            <i class="fas fa-paint-brush style-icon"></i>
                            <div class="style-name">Illustration</div>
                            <div class="style-desc">Digital artwork</div>
                        </div>
                    </div>
                </div>
                
                <!-- Aspect Ratio -->
                <div class="aspect-section">
                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 12px;">
                        <i class="fas fa-expand-alt"></i>
                        Aspect Ratio
                    </div>
                    <div class="aspect-options">
                        <div class="aspect-option active" data-aspect="1:1">
                            <div class="aspect-ratio">1:1</div>
                            <div class="aspect-desc">Square</div>
                        </div>
                        <div class="aspect-option" data-aspect="4:5">
                            <div class="aspect-ratio">4:5</div>
                            <div class="aspect-desc">Portrait</div>
                        </div>
                        <div class="aspect-option" data-aspect="16:9">
                            <div class="aspect-ratio">16:9</div>
                            <div class="aspect-desc">Landscape</div>
                        </div>
                        <div class="aspect-option" data-aspect="9:16">
                            <div class="aspect-ratio">9:16</div>
                            <div class="aspect-desc">Vertical</div>
                        </div>
                    </div>
                </div>
                
                <!-- Memory Settings -->
                <div class="memory-section">
                    <div class="memory-header">
                        <div class="memory-title">
                            <i class="fas fa-database"></i>
                            AI Memory
                        </div>
                        <div class="memory-toggle" id="memoryToggle">
                            <span style="font-size: 13px; color: var(--text-secondary);">Learning</span>
                            <div class="toggle-switch active">
                                <div class="toggle-knob"></div>
                            </div>
                        </div>
                    </div>
                    <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.5;">
                        AI learns from your previous generations to provide better suggestions and improvements.
                    </div>
                </div>
                
                <!-- Generate Button -->
                <div class="generate-section">
                    <button id="generateButton" class="generate-button">
                        <i class="fas fa-magic"></i>
                        Generate Smart Image
                    </button>
                    <div class="daily-limit" id="dailyLimit">
                        Daily limit reached. Come back tomorrow!
                    </div>
                </div>
            </div>
            
            <!-- Gallery Area -->
            <div class="gallery-area">
                <div class="gallery-header">
                    <h3 class="gallery-title">Your AI Gallery</h3>
                    <div class="gallery-actions">
                        <button id="downloadButton" class="gallery-button" disabled>
                            <i class="fas fa-download"></i>
                            Download
                        </button>
                        <button id="regenerateButton" class="gallery-button" disabled>
                            <i class="fas fa-redo"></i>
                            Regenerate
                        </button>
                        <button id="enhanceButton" class="gallery-button" disabled>
                            <i class="fas fa-star"></i>
                            Enhance
                        </button>
                    </div>
                </div>
                
                <!-- Current Image -->
                <div class="current-image-container">
                    <!-- Placeholder -->
                    <div class="placeholder-content" id="placeholderContent">
                        <i class="fas fa-image placeholder-icon"></i>
                        <div class="placeholder-title">Your AI-generated masterpiece awaits</div>
                        <div class="placeholder-text">
                            Describe what you want to create. AI will remember your preferences and improve over time.
                        </div>
                    </div>
                    
                    <!-- Generated Image -->
                    <div class="generated-image" id="generatedImage">
                        <div class="image-overlay" id="imageOverlay">
                            <div class="image-prompt" id="currentPrompt">-</div>
                            <div class="image-meta" id="currentMeta">-</div>
                        </div>
                        <div class="image-badges">
                            <div class="image-badge badge-ai">
                                <i class="fas fa-robot"></i>
                                AI GENERATED
                            </div>
                            <div class="image-badge badge-memory" id="memoryBadge" style="display: none;">
                                <i class="fas fa-brain"></i>
                                SMART MEMORY
                            </div>
                        </div>
                        <img id="currentImage" src="" alt="AI Generated Image">
                    </div>
                    
                    <!-- Loading -->
                    <div class="loading-overlay" id="loadingOverlay">
                        <div class="loading-spinner"></div>
                        <div class="loading-text">Creating with AI Memory...</div>
                        <div class="loading-subtext">
                            Analyzing your previous generations to create the perfect image.
                            This may take 15-30 seconds.
                        </div>
                    </div>
                </div>
                
                <!-- Regeneration Options -->
                <div class="regeneration-options" id="regenerationOptions">
                    <div class="regeneration-title">
                        <i class="fas fa-redo-alt"></i>
                        Regeneration Options
                    </div>
                    <div class="regeneration-buttons">
                        <button class="regeneration-button" id="regenerateSimilar">
                            <i class="fas fa-copy"></i>
                            Generate Similar
                        </button>
                        <button class="regeneration-button" id="regenerateBetter">
                            <i class="fas fa-arrow-up"></i>
                            Generate Better Quality
                        </button>
                        <button class="regeneration-button" id="regenerateDifferent">
                            <i class="fas fa-random"></i>
                            Generate Different Style
                        </button>
                    </div>
                </div>
                
                <!-- Error Message -->
                <div class="error-message" id="errorMessage">
                    <i class="fas fa-exclamation-triangle error-icon"></i>
                    <div>
                        <strong>Generation Failed</strong>
                        <p id="errorText">An error occurred while generating the image. Please try again.</p>
                    </div>
                </div>
                
                <!-- History Gallery -->
                <div class="history-gallery">
                    <div class="history-header">
                        <div class="history-title">
                            <i class="fas fa-images"></i>
                            Generation History
                        </div>
                        <div class="history-filter">
                            <button class="filter-button active" data-filter="all">All</button>
                            <button class="filter-button" data-filter="today">Today</button>
                            <button class="filter-button" data-filter="week">This Week</button>
                        </div>
                    </div>
                    <div class="photo-grid" id="photoGrid">
                        <!-- History photos will appear here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="google-footer">
        <div class="container">
            <p>Google Photos AI Studio - Smart Image Generation with Memory</p>
            <p style="margin-top: 8px; color: var(--text-tertiary); font-size: 13px;">
                AI learns from your creations • No watermarks • 100 free images daily
            </p>
            <div class="footer-links">
                <a href="#">Privacy</a>
                <a href="#">Terms</a>
                <a href="#">Help</a>
                <a href="#">Feedback</a>
                <a href="#">About</a>
            </div>
        </div>
    </footer>

    <script>
        // AI Image Generator with Memory System
        class AIImageGenerator {
            constructor() {
                this.currentImage = null;
                this.currentImageData = null;
                this.dailyCount = 0;
                this.totalImages = 0;
                this.history = [];
                this.memoryEnabled = true;
                this.styleLearning = {};
                this.aspectLearning = {};
                this.promptPatterns = [];
                
                this.init();
            }
            
            init() {
                this.loadFromStorage();
                this.setupEventListeners();
                this.updateStats();
                this.renderHistory();
                this.generateSuggestions();
            }
            
            loadFromStorage() {
                // Load daily count
                const today = new Date().toDateString();
                const dailyData = localStorage.getItem('aiStudioDaily');
                if (dailyData) {
                    const { date, count } = JSON.parse(dailyData);
                    this.dailyCount = date === today ? count : 0;
                }
                
                // Load total images
                this.totalImages = parseInt(localStorage.getItem('aiStudioTotal') || '0');
                
                // Load history
                const historyData = localStorage.getItem('aiStudioHistory');
                if (historyData) {
                    this.history = JSON.parse(historyData);
                    this.analyzeHistory();
                }
                
                // Load memory settings
                const memoryData = localStorage.getItem('aiStudioMemory');
                if (memoryData) {
                    const settings = JSON.parse(memoryData);
                    this.memoryEnabled = settings.enabled !== false;
                    this.styleLearning = settings.styleLearning || {};
                    this.aspectLearning = settings.aspectLearning || {};
                    this.promptPatterns = settings.promptPatterns || [];
                }
            }
            
            saveToStorage() {
                // Save daily count
                const today = new Date().toDateString();
                localStorage.setItem('aiStudioDaily', JSON.stringify({
                    date: today,
                    count: this.dailyCount
                }));
                
                // Save total images
                localStorage.setItem('aiStudioTotal', this.totalImages.toString());
                
                // Save history (limit to 50 entries)
                if (this.history.length > 50) {
                    this.history = this.history.slice(0, 50);
                }
                localStorage.setItem('aiStudioHistory', JSON.stringify(this.history));
                
                // Save memory settings
                localStorage.setItem('aiStudioMemory', JSON.stringify({
                    enabled: this.memoryEnabled,
                    styleLearning: this.styleLearning,
                    aspectLearning: this.aspectLearning,
                    promptPatterns: this.promptPatterns
                }));
            }
            
            analyzeHistory() {
                // Analyze user preferences from history
                this.styleLearning = {};
                this.aspectLearning = {};
                this.promptPatterns = [];
                
                this.history.forEach(item => {
                    // Count style preferences
                    this.styleLearning[item.style] = (this.styleLearning[item.style] || 0) + 1;
                    
                    // Count aspect preferences
                    this.aspectLearning[item.aspect] = (this.aspectLearning[item.aspect] || 0) + 1;
                    
                    // Extract prompt patterns
                    const words = item.prompt.toLowerCase().split(' ');
                    words.forEach(word => {
                        if (word.length > 3 && !['with', 'and', 'the', 'this', 'that'].includes(word)) {
                            this.promptPatterns.push(word);
                        }
                    });
                });
                
                // Limit prompt patterns
                this.promptPatterns = [...new Set(this.promptPatterns)].slice(0, 50);
            }
            
            setupEventListeners() {
                // Generate button
                document.getElementById('generateButton').addEventListener('click', () => this.generate());
                
                // Download button
                document.getElementById('downloadButton').addEventListener('click', () => this.download());
                
                // Regenerate button
                document.getElementById('regenerateButton').addEventListener('click', () => this.showRegenerationOptions());
                
                // Regeneration options
                document.getElementById('regenerateSimilar').addEventListener('click', () => this.regenerateSimilar());
                document.getElementById('regenerateBetter').addEventListener('click', () => this.regenerateBetter());
                document.getElementById('regenerateDifferent').addEventListener('click', () => this.regenerateDifferent());
                
                // Enhance button
                document.getElementById('enhanceButton').addEventListener('click', () => this.enhance());
                
                // Memory toggle
                document.getElementById('memoryToggle').addEventListener('click', () => this.toggleMemory());
                
                // Prompt actions
                document.getElementById('suggestBtn').addEventListener('click', () => this.showSuggestions());
                document.getElementById('historyBtn').addEventListener('click', () => this.toggleHistory());
                document.getElementById('clearBtn').addEventListener('click', () => this.clearPrompt());
                
                // Style selection
                document.querySelectorAll('.style-option').forEach(option => {
                    option.addEventListener('click', () => {
                        document.querySelectorAll('.style-option').forEach(o => o.classList.remove('active'));
                        option.classList.add('active');
                    });
                });
                
                // Aspect selection
                document.querySelectorAll('.aspect-option').forEach(option => {
                    option.addEventListener('click', () => {
                        document.querySelectorAll('.aspect-option').forEach(o => o.classList.remove('active'));
                        option.classList.add('active');
                    });
                });
                
                // Filter buttons
                document.querySelectorAll('.filter-button').forEach(button => {
                    button.addEventListener('click', () => {
                        document.querySelectorAll('.filter-button').forEach(b => b.classList.remove('active'));
                        button.classList.add('active');
                        this.filterHistory(button.dataset.filter);
                    });
                });
                
                // Ctrl+Enter shortcut
                document.getElementById('promptInput').addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && e.ctrlKey) {
                        e.preventDefault();
                        this.generate();
                    }
                });
            }
            
            updateStats() {
                document.getElementById('totalImages').textContent = this.totalImages;
                document.getElementById('todayCount').textContent = `${this.dailyCount}/100`;
                document.getElementById('memorySize').textContent = this.history.length;
                
                // Update daily limit message
                const dailyLimit = document.getElementById('dailyLimit');
                const generateButton = document.getElementById('generateButton');
                
                if (this.dailyCount >= 100) {
                    dailyLimit.style.display = 'block';
                    generateButton.disabled = true;
                    generateButton.innerHTML = '<i class="fas fa-lock"></i> Daily Limit Reached';
                } else {
                    dailyLimit.style.display = 'none';
                    generateButton.disabled = false;
                    generateButton.innerHTML = '<i class="fas fa-magic"></i> Generate Smart Image';
                }
            }
            
            getSelectedStyle() {
                const activeStyle = document.querySelector('.style-option.active');
                return activeStyle ? activeStyle.dataset.style : 'realistic';
            }
            
            getSelectedAspect() {
                const activeAspect = document.querySelector('.aspect-option.active');
                return activeAspect ? activeAspect.dataset.aspect : '1:1';
            }
            
            getImageDimensions(aspect) {
                switch(aspect) {
                    case '4:5': return { width: 896, height: 1120 };
                    case '16:9': return { width: 1280, height: 720 };
                    case '9:16': return { width: 720, height: 1280 };
                    case '1:1':
                    default: return { width: 1024, height: 1024 };
                }
            }
            
            async generate() {
                const promptInput = document.getElementById('promptInput');
                const prompt = promptInput.value.trim();
                
                if (!prompt) {
                    this.showError('Please enter a description for your image');
                    return;
                }
                
                if (this.dailyCount >= 100) {
                    this.showError('Daily limit reached. Please come back tomorrow.');
                    return;
                }
                
                // Show loading
                this.showLoading();
                
                try {
                    const style = this.getSelectedStyle();
                    const aspect = this.getSelectedAspect();
                    const { width, height } = this.getImageDimensions(aspect);
                    
                    // Build enhanced prompt with memory
                    const enhancedPrompt = this.buildEnhancedPrompt(prompt, style);
                    
                    // Generate image using AI API
                    const imageUrl = await this.generateImage(enhancedPrompt, width, height);
                    
                    // Create image data object
                    const imageData = {
                        id: Date.now(),
                        prompt: prompt,
                        enhancedPrompt: enhancedPrompt,
                        style: style,
                        aspect: aspect,
                        size: `${width}×${height}`,
                        date: new Date().toLocaleString(),
                        timestamp: Date.now(),
                        imageUrl: imageUrl,
                        thumbnail: imageUrl
                    };
                    
                    // Display image
                    this.displayImage(imageData);
                    
                    // Save to history
                    this.history.unshift(imageData);
                    this.currentImageData = imageData;
                    
                    // Update counters
                    this.dailyCount++;
                    this.totalImages++;
                    
                    // Save to storage
                    this.saveToStorage();
                    
                    // Analyze and learn from this generation
                    if (this.memoryEnabled) {
                        this.learnFromGeneration(imageData);
                    }
                    
                    // Update UI
                    this.updateStats();
                    this.renderHistory();
                    this.generateSuggestions();
                    
                    // Show memory badge if learning is active
                    if (this.memoryEnabled) {
                        document.getElementById('memoryBadge').style.display = 'flex';
                    }
                    
                } catch (error) {
                    console.error('Generation error:', error);
                    this.hideLoading();
                    this.showError(error.message || 'Failed to generate image. Please try again.');
                }
            }
            
            buildEnhancedPrompt(prompt, style) {
                let enhancedPrompt = prompt;
                
                // Add quality terms
                enhancedPrompt += ', highly detailed, ultra high resolution, sharp focus, professional quality';
                
                // Add style-specific terms
                const styleTerms = {
                    realistic: 'photorealistic, DSLR photography, realistic lighting, detailed textures',
                    cinematic: 'cinematic, dramatic lighting, film grain, movie still, Hollywood quality',
                    anime: 'anime style, Japanese animation, clean lines, vibrant colors',
                    illustration: 'digital art, illustration, artistic, vibrant colors'
                };
                
                if (styleTerms[style]) {
                    enhancedPrompt += `, ${styleTerms[style]}`;
                }
                
                // Add memory-based improvements if available
                if (this.memoryEnabled && this.history.length > 0) {
                    // Learn from user's preferred terms
                    const userTerms = this.extractUserTerms();
                    if (userTerms.length > 0) {
                        enhancedPrompt += `, ${userTerms.slice(0, 3).join(', ')}`;
                    }
                }
                
                // Remove duplicate words
                const words = enhancedPrompt.split(', ');
                const uniqueWords = [...new Set(words)];
                enhancedPrompt = uniqueWords.join(', ');
                
                return enhancedPrompt;
            }
            
            extractUserTerms() {
                // Extract frequently used terms from user's history
                const termCount = {};
                this.history.slice(0, 10).forEach(item => {
                    const words = item.prompt.toLowerCase().split(' ');
                    words.forEach(word => {
                        if (word.length > 4 && !['with', 'and', 'the', 'this', 'that', 'photo', 'image'].includes(word)) {
                            termCount[word] = (termCount[word] || 0) + 1;
                        }
                    });
                });
                
                // Sort by frequency
                return Object.entries(termCount)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 5)
                    .map(([term]) => term);
            }
            
            async generateImage(prompt, width, height) {
                // Use Pollinations AI API
                const seed = Math.floor(Math.random() * 1000000);
                const apiUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?width=${width}&height=${height}&nologo=true&seed=${seed}&model=stable-diffusion`;
                
                const response = await fetch(apiUrl, { headers: { 'Accept': 'image/*' } });
                
                if (!response.ok) {
                    throw new Error('AI service is busy. Please try again.');
                }
                
                const blob = await response.blob();
                
                if (!blob || blob.size < 5000) {
                    throw new Error('Generated image is invalid');
                }
                
                return URL.createObjectURL(blob);
            }
            
            displayImage(imageData) {
                const currentImage = document.getElementById('currentImage');
                const generatedImage = document.getElementById('generatedImage');
                const placeholderContent = document.getElementById('placeholderContent');
                const imageOverlay = document.getElementById('imageOverlay');
                const currentPrompt = document.getElementById('currentPrompt');
                const currentMeta = document.getElementById('currentMeta');
                
                currentImage.src = imageData.imageUrl;
                currentImage.onload = () => {
                    this.hideLoading();
                    placeholderContent.style.display = 'none';
                    generatedImage.style.display = 'block';
                    
                    // Update overlay info
                    currentPrompt.textContent = imageData.prompt;
                    currentMeta.textContent = `${imageData.style} • ${imageData.size} • ${imageData.date}`;
                    
                    // Enable buttons
                    document.getElementById('downloadButton').disabled = false;
                    document.getElementById('regenerateButton').disabled = false;
                    document.getElementById('enhanceButton').disabled = false;
                    
                    // Show overlay on hover
                    generatedImage.addEventListener('mouseenter', () => {
                        imageOverlay.style.display = 'block';
                    });
                    
                    generatedImage.addEventListener('mouseleave', () => {
                        imageOverlay.style.display = 'none';
                    });
                };
            }
            
            showLoading() {
                document.getElementById('loadingOverlay').style.display = 'flex';
                document.getElementById('generatedImage').style.display = 'none';
                document.getElementById('placeholderContent').style.display = 'none';
                document.getElementById('errorMessage').style.display = 'none';
            }
            
            hideLoading() {
                document.getElementById('loadingOverlay').style.display = 'none';
            }
            
            showError(message) {
                const errorMessage = document.getElementById('errorMessage');
                const errorText = document.getElementById('errorText');
                
                errorText.textContent = message;
                errorMessage.style.display = 'flex';
                
                setTimeout(() => {
                    errorMessage.style.display = 'none';
                }, 5000);
            }
            
            learnFromGeneration(imageData) {
                // Update style learning
                this.styleLearning[imageData.style] = (this.styleLearning[imageData.style] || 0) + 1;
                
                // Update aspect learning
                this.aspectLearning[imageData.aspect] = (this.aspectLearning[imageData.aspect] || 0) + 1;
                
                // Extract and save prompt patterns
                const words = imageData.prompt.toLowerCase().split(' ');
                words.forEach(word => {
                    if (word.length > 3 && !['with', 'and', 'the', 'this', 'that'].includes(word)) {
                        this.promptPatterns.push(word);
                    }
                });
                
                // Limit prompt patterns
                this.promptPatterns = [...new Set(this.promptPatterns)].slice(0, 50);
                
                // Save updated memory
                this.saveToStorage();
            }
            
            generateSuggestions() {
                if (!this.memoryEnabled || this.history.length === 0) return;
                
                const suggestions = [];
                const suggestionChips = document.getElementById('suggestionChips');
                const smartSuggestions = document.getElementById('smartSuggestions');
                
                // Generate suggestions based on user's history
                
                // 1. Most used style suggestion
                const favoriteStyle = Object.entries(this.styleLearning)
                    .sort((a, b) => b[1] - a[1])[0];
                
                if (favoriteStyle) {
                    suggestions.push(`Try more ${favoriteStyle[0]} style images`);
                }
                
                // 2. Aspect ratio suggestion
                const favoriteAspect = Object.entries(this.aspectLearning)
                    .sort((a, b) => b[1] - a[1])[0];
                
                if (favoriteAspect) {
                    suggestions.push(`Try ${favoriteAspect[0]} aspect ratio`);
                }
                
                // 3. Common theme suggestions
                const themes = this.extractThemes();
                if (themes.length > 0) {
                    suggestions.push(`Create more ${themes[0]} themed images`);
                }
                
                // 4. Quality improvement suggestion
                suggestions.push('Add more details for better quality');
                
                // 5. Variety suggestion
                if (Object.keys(this.styleLearning).length > 2) {
                    suggestions.push('Try a different art style for variety');
                }
                
                // Update suggestion chips
                suggestionChips.innerHTML = '';
                suggestions.slice(0, 4).forEach(suggestion => {
                    const chip = document.createElement('div');
                    chip.className = 'suggestion-chip';
                    chip.textContent = suggestion;
                    chip.addEventListener('click', () => {
                        document.getElementById('promptInput').value += ' ' + suggestion.replace('Try ', '').replace('Add ', '').replace('Create more ', '');
                    });
                    suggestionChips.appendChild(chip);
                });
                
                // Show suggestions
                smartSuggestions.classList.add('active');
            }
            
            extractThemes() {
                // Extract common themes from history
                const themes = [];
                const commonThemes = {
                    'portrait': ['person', 'woman', 'man', 'face', 'portrait'],
                    'landscape': ['mountain', 'forest', 'ocean', 'sky', 'sunset'],
                    'fantasy': ['dragon', 'magic', 'castle', 'fantasy', 'mythical'],
                    'scifi': ['future', 'robot', 'spaceship', 'cyberpunk', 'scifi'],
                    'animal': ['cat', 'dog', 'lion', 'tiger', 'animal'],
                    'food': ['food', 'fruit', 'meal', 'delicious', 'cooking']
                };
                
                Object.entries(commonThemes).forEach(([theme, keywords]) => {
                    let matches = 0;
                    this.history.slice(0, 10).forEach(item => {
                        keywords.forEach(keyword => {
                            if (item.prompt.toLowerCase().includes(keyword)) {
                                matches++;
                            }
                        });
                    });
                    
                    if (matches > 2) {
                        themes.push(theme);
                    }
                });
                
                return themes;
            }
            
            showRegenerationOptions() {
                document.getElementById('regenerationOptions').classList.add('active');
            }
            
            regenerateSimilar() {
                if (!this.currentImageData) return;
                
                // Use similar settings but with slight variations
                document.getElementById('promptInput').value = this.currentImageData.prompt;
                this.generate();
            }
            
            regenerateBetter() {
                if (!this.currentImageData) return;
                
                // Add quality enhancement terms
                const betterPrompt = this.currentImageData.prompt + ', ultra detailed, maximum quality, 8k resolution';
                document.getElementById('promptInput').value = betterPrompt;
                this.generate();
            }
            
            regenerateDifferent() {
                if (!this.currentImageData) return;
                
                // Keep prompt but change style
                const currentStyle = this.getSelectedStyle();
                const styles = ['realistic', 'cinematic', 'anime', 'illustration'];
                const newStyle = styles.find(style => style !== currentStyle) || 'realistic';
                
                // Update style selection
                document.querySelectorAll('.style-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.style === newStyle) {
                        option.classList.add('active');
                    }
                });
                
                this.generate();
            }
            
            enhance() {
                // Simulate enhancement by applying a filter
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = () => {
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.drawImage(img, 0, 0);
                    
                    // Apply enhancement filter
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const data = imageData.data;
                    
                    // Simple enhancement: increase contrast and saturation
                    for (let i = 0; i < data.length; i += 4) {
                        // Increase contrast
                        data[i] = (data[i] - 128) * 1.1 + 128;
                        data[i + 1] = (data[i + 1] - 128) * 1.1 + 128;
                        data[i + 2] = (data[i + 2] - 128) * 1.1 + 128;
                        
                        // Increase saturation
                        const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
                        data[i] = avg + (data[i] - avg) * 1.2;
                        data[i + 1] = avg + (data[i + 1] - avg) * 1.2;
                        data[i + 2] = avg + (data[i + 2] - avg) * 1.2;
                    }
                    
                    ctx.putImageData(imageData, 0, 0);
                    
                    // Update displayed image
                    const enhancedUrl = canvas.toDataURL('image/png');
                    document.getElementById('currentImage').src = enhancedUrl;
                    
                    // Show enhancement feedback
                    const enhanceButton = document.getElementById('enhanceButton');
                    const originalHTML = enhanceButton.innerHTML;
                    enhanceButton.innerHTML = '<i class="fas fa-check"></i> Enhanced!';
                    enhanceButton.style.background = 'rgba(52, 168, 83, 0.2)';
                    enhanceButton.style.borderColor = 'rgba(52, 168, 83, 0.5)';
                    
                    setTimeout(() => {
                        enhanceButton.innerHTML = originalHTML;
                        enhanceButton.style.background = '';
                        enhanceButton.style.borderColor = '';
                    }, 2000);
                };
                
                img.src = this.currentImageData.imageUrl;
            }
            
            download() {
                if (!this.currentImageData) return;
                
                const link = document.createElement('a');
                link.href = this.currentImageData.imageUrl;
                link.download = `ai-photo-${Date.now()}.png`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Show feedback
                const downloadButton = document.getElementById('downloadButton');
                const originalHTML = downloadButton.innerHTML;
                downloadButton.innerHTML = '<i class="fas fa-check"></i> Downloaded!';
                downloadButton.style.background = 'rgba(52, 168, 83, 0.2)';
                downloadButton.style.borderColor = 'rgba(52, 168, 83, 0.5)';
                
                setTimeout(() => {
                    downloadButton.innerHTML = originalHTML;
                    downloadButton.style.background = '';
                    downloadButton.style.borderColor = '';
                }, 2000);
            }
            
            toggleMemory() {
                const toggleSwitch = document.querySelector('.toggle-switch');
                this.memoryEnabled = !this.memoryEnabled;
                toggleSwitch.classList.toggle('active');
                
                if (this.memoryEnabled) {
                    this.generateSuggestions();
                } else {
                    document.getElementById('smartSuggestions').classList.remove('active');
                }
                
                this.saveToStorage();
            }
            
            showSuggestions() {
                this.generateSuggestions();
            }
            
            toggleHistory() {
                const previousPrompts = document.getElementById('previousPrompts');
                const promptHistory = document.getElementById('promptHistory');
                
                // Populate history
                promptHistory.innerHTML = '';
                this.history.slice(0, 10).forEach(item => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.innerHTML = `
                        <div>${item.prompt.substring(0, 60)}${item.prompt.length > 60 ? '...' : ''}</div>
                        <div class="history-date">${item.date}</div>
                    `;
                    
                    historyItem.addEventListener('click', () => {
                        document.getElementById('promptInput').value = item.prompt;
                        previousPrompts.classList.remove('active');
                    });
                    
                    promptHistory.appendChild(historyItem);
                });
                
                previousPrompts.classList.toggle('active');
            }
            
            clearPrompt() {
                document.getElementById('promptInput').value = '';
            }
            
            renderHistory() {
                const photoGrid = document.getElementById('photoGrid');
                photoGrid.innerHTML = '';
                
                this.history.slice(0, 12).forEach(item => {
                    const photoCard = this.createPhotoCard(item);
                    photoGrid.appendChild(photoCard);
                });
            }
            
            createPhotoCard(item) {
                const card = document.createElement('div');
                card.className = 'photo-card';
                card.innerHTML = `
                    <img src="${item.thumbnail}" alt="${item.prompt}" class="photo-thumb">
                    <div class="photo-info">
                        <div class="photo-prompt">${item.prompt.substring(0, 40)}${item.prompt.length > 40 ? '...' : ''}</div>
                        <div class="photo-date">${item.date}</div>
                    </div>
                    <div class="photo-actions">
                        <button class="photo-action-btn" title="Load">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="photo-action-btn" title="Regenerate">
                            <i class="fas fa-redo"></i>
                        </button>
                    </div>
                `;
                
                // Load image on click
                card.addEventListener('click', (e) => {
                    if (!e.target.closest('.photo-action-btn')) {
                        this.loadHistoryItem(item);
                    }
                });
                
                // Action buttons
                const loadBtn = card.querySelector('.photo-action-btn:nth-child(1)');
                const regenerateBtn = card.querySelector('.photo-action-btn:nth-child(2)');
                
                loadBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.loadHistoryItem(item);
                });
                
                regenerateBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    document.getElementById('promptInput').value = item.prompt;
                    this.generate();
                });
                
                return card;
            }
            
            loadHistoryItem(item) {
                this.displayImage(item);
                this.currentImageData = item;
                
                // Update style selection
                document.querySelectorAll('.style-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.style === item.style) {
                        option.classList.add('active');
                    }
                });
                
                // Update aspect selection
                document.querySelectorAll('.aspect-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.aspect === item.aspect) {
                        option.classList.add('active');
                    }
                });
            }
            
            filterHistory(filter) {
                // For now, just render all history
                // In a real app, you would filter by date
                this.renderHistory();
            }
        }
        
        // Initialize the app
        window.addEventListener('load', () => {
            const aiGenerator = new AIImageGenerator();
            
            // Make it globally accessible for debugging
            window.aiGenerator = aiGenerator;
            
            // Focus on prompt input
            document.getElementById('promptInput').focus();
            
            // Set example prompt
            const examples = [
                "A beautiful sunset over mountains with dramatic lighting",
                "Japanese garden with cherry blossoms in spring",
                "Portrait of a woman with detailed traditional jewelry",
                "Fantasy landscape with glowing mushrooms and magical creatures",
                "Cyberpunk city street at night with neon lights"
            ];
            
            const randomExample = examples[Math.floor(Math.random() * examples.length)];
            document.getElementById('promptInput').placeholder = `Describe your image... Example: ${randomExample}`;
        });
    </script>
</body>
</html>
